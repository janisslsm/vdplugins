(function(f,o,c,l,y,$,w){"use strict";const j=c.findByProps("canUseEmojisEverywhere");var b=[l.instead("canUseEmojisEverywhere",j,function(){return!0}),l.instead("canUseAnimatedEmojis",j,function(){return!0})];const{getCustomEmojiById:R}=c.findByStoreName("EmojiStore"),{getGuildId:z}=c.findByStoreName("SelectedGuildStore"),B=/<a?:(\w+):(\d+)>/i;function k(e,r){const t=e.matchAll(/<a?:(\w+):(\d+)>/gi),a=[];for(const s of t){const n=R(s[2]);(n.guildId!=z()||n.animated)&&(e=e.replace(s[0],""),o.storage.hyperLink===!0?a.push(`[${n.name}](${n.url.split("?")[0]}?size=${r}&name=${n.name})`):a.push(`${n.url.split("?")[0]}?size=${r}&name=${n.name}`))}return{newContent:e.trim(),extractedEmojis:a}}function h(e){if(!e.content.match(B))return;const{newContent:r,extractedEmojis:t}=k(e.content,o.storage.emojiSize);e.content=r,t.length>0&&(e.content+=`
`+t.join(`
`)),e.invalidEmojis=[]}const L=c.findByProps("sendMessage","receiveMessage"),P=c.findByProps("uploadLocalFiles");var _=[l.before("sendMessage",L,function(e){return h(e[1])}),l.before("uploadLocalFiles",P,function(e){return h(e[0].parsedMessage)})];const{getCustomEmojiById:C}=c.findByStoreName("EmojiStore"),p=c.findByName("RowManager"),d=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;var F=[l.before("generate",p.prototype,function(e){let[r]=e;if(r.rowType!==1)return;let t=r.message.content;if(!t?.length)return;const a=t.match(d)?.index;if(a===void 0)return;const s=t.slice(a).trim().split(`
`);if(!s.every(function(i){return i.match(d)}))return;for(t=t.slice(0,a);t.indexOf("  ")!==-1;)t=t.replace("  ",` ${s.shift()} `);t=t.trim(),s.length&&(t+=` ${s.join(" ")}`);const n=r.message.embeds;for(let i=0;i<n.length;i++){const m=n[i];m.type==="image"&&m.url.match(d)&&n.splice(i--,1)}r.message.content=t,r.__realmoji=!0}),l.after("generate",p.prototype,function(e,r){let[t]=e;if(t.rowType!==1||t.__realmoji!==!0)return;const{content:a}=r.message;if(!Array.isArray(a))return;const s=a.every(function(n){return n.type==="link"&&n.target.match(d)||n.type==="text"&&n.content===" "});for(let n=0;n<a.length;n++){const i=a[n];if(i.type!=="link")continue;const m=i.target.match(d);if(!m)continue;const v=i.target.split("&"),S=`${m[0]}?size=128`;let u=C(m[1])?.name;u===void 0&&(u="<realmoji>"),v[1]?.startsWith("name")&&(u=v[1].replace("name=","")),a[n]={type:"customEmoji",id:m[1],alt:u,src:S,frozenSrc:S.replace("gif","webp"),jumboable:s?!0:void 0}}})];const{FormSection:g,FormRadioRow:M,FormSwitchRow:E,FormDivider:x}=$.Forms,N={Tiny:16,Small:32,Medium:48,Large:64,Huge:96,Jumbo:128},T="https://cdn.discordapp.com/emojis/926602689213767680.webp";function U(){return w.useProxy(o.storage),React.createElement(y.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(g,{title:"Emoji Size",titleStyleType:"no_border"},Object.entries(N).map(function(e){let[r,t]=e;return React.createElement(M,{label:r,subLabel:t,selected:o.storage.emojiSize===t,onPress:function(){o.storage.emojiSize=t}})})),React.createElement(g,{title:"Preview"},React.createElement(y.ReactNative.Image,{source:{uri:`${T}?size=${o.storage.emojiSize}`,width:o.storage.emojiSize,height:o.storage.emojiSize}})),React.createElement(g,{title:"User Profile",titleStyleType:"no_border"},React.createElement(E,{label:"Use hyperlinks when sending fake emojis",onValueChange:function(e){o.storage.hyperLink=e},value:o.storage.hyperLink}),React.createElement(x,null),React.createElement(E,{label:"Transform fake emojis into real ones",onValueChange:function(e){o.storage.transformEmoji=e},value:o.storage.transformEmoji})))}o.storage.emojiSize??=48,o.storage.hyperLink??=!0,o.storage.transformEmoji??=!0;const I=[...b,..._,...F];var A={settings:U,onUnload:function(){return I.forEach(function(e){return e()})}};return f.default=A,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
