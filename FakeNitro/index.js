(function(g,o,m,d,j,b,R){"use strict";const v=m.findByProps("canUseEmojisEverywhere");var $=[d.instead("canUseEmojisEverywhere",v,function(){return!0}),d.instead("canUseAnimatedEmojis",v,function(){return!0})];const{getCustomEmojiById:z}=m.findByStoreName("EmojiStore"),{getGuildId:B}=m.findByStoreName("SelectedGuildStore"),k=/<a?:(\w+):(\d+)>/i;function P(e,i){const n=e.matchAll(/<a?:(\w+):(\d+)>/gi),t=[];for(const c of n){const r=z(c[2]);(r.guildId!=B()||r.animated)&&(e=e.replace(c[0],""),t.push(`[${r.name}](${r.url.split("?")[0]}?size=${i}&name=${r.name})`))}return{newContent:e.trim(),extractedEmojis:t}}function p(e){if(!e.content.match(k))return;const{newContent:i,extractedEmojis:n}=P(e.content,o.storage.emojiSize);e.content=i,n.length>0&&(e.content+=`
`+n.join(`
`)),e.invalidEmojis=[]}const _=m.findByProps("sendMessage","receiveMessage"),C=m.findByProps("uploadLocalFiles");var F=[d.before("sendMessage",_,function(e){return p(e[1])}),d.before("uploadLocalFiles",C,function(e){return p(e[0].parsedMessage)})];const{getCustomEmojiById:L}=m.findByStoreName("EmojiStore"),h=m.findByName("RowManager"),f=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;var M=[d.before("generate",h.prototype,function(e){let[i]=e;var n;if(i.rowType!==1)return;let t=i.message.content;if(!t?.length)return;const c=(n=t.match(f))===null||n===void 0?void 0:n.index;if(c===void 0)return;const r=t.slice(c).trim().split(`
`);if(!r.every(function(s){return s.match(f)}))return;for(t=t.slice(0,c);t.indexOf("  ")!==-1;)t=t.replace("  ",` ${r.shift()} `);t=t.trim(),r.length&&(t+=` ${r.join(" ")}`);const a=i.message.embeds;for(let s=0;s<a.length;s++){const l=a[s];l.type==="image"&&l.url.match(f)&&a.splice(s--,1)}i.message.content=t,i.__realmoji=!0}),d.after("generate",h.prototype,function(e,i){let[n]=e;if(n.rowType!==1||n.__realmoji!==!0)return;const{content:t}=i.message;if(!Array.isArray(t))return;const c=t.every(function(a){return a.type==="link"&&a.target.match(f)||a.type==="text"&&a.content===" "});for(let a=0;a<t.length;a++){var r;const s=t[a];if(s.type!=="link")continue;const l=s.target.match(f);if(!l)continue;const S=s.target.split("&"),w=`${l[0]}?size=128`;let u=L(l[1])?.name;u===void 0&&(u="<realmoji>"),!((r=S[1])===null||r===void 0)&&r.startsWith("name")&&(u=S[1].replace("name=","")),t[a]={type:"customEmoji",id:l[1],alt:u,src:w,frozenSrc:w.replace("gif","webp"),jumboable:c?!0:void 0}}})];const{FormSection:y,FormRadioRow:x,FormSwitchRow:E,FormDivider:N}=b.Forms,T={Tiny:16,Small:32,Medium:48,Large:64,Huge:96,Jumbo:128},U="https://cdn.discordapp.com/emojis/926602689213767680.webp";function I(){return R.useProxy(o.storage),React.createElement(j.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(y,{title:"Emoji Size",titleStyleType:"no_border"},Object.entries(T).map(function(e){let[i,n]=e;return React.createElement(x,{label:i,subLabel:n,selected:o.storage.emojiSize===n,onPress:function(){o.storage.emojiSize=n}})})),React.createElement(y,{title:"Preview"},React.createElement(j.ReactNative.Image,{source:{uri:`${U}?size=${o.storage.emojiSize}`,width:o.storage.emojiSize,height:o.storage.emojiSize}})),React.createElement(y,{title:"User Profile",titleStyleType:"no_border"},React.createElement(E,{label:"Use hyperlinks when sending fake emojis",onValueChange:function(e){o.storage.hyperLink=e},value:o.storage.hyperLink}),React.createElement(N,null),React.createElement(E,{label:"Transform fake emojis into real ones",onValueChange:function(e){o.storage.transformEmoji=e},value:o.storage.transformEmoji})))}o.storage.emojiSize??=48,o.storage.hyperLink??=!0,o.storage.transformEmoji??=!0;const A=[...$,...F,...M];var O={settings:I,onUnload:function(){return A.forEach(function(e){return e()})}};return g.default=O,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
