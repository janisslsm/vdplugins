(function(g,o,m,d,j,w,b){"use strict";const v=m.findByProps("canUseEmojisEverywhere");var R=[d.instead("canUseEmojisEverywhere",v,function(){return!0}),d.instead("canUseAnimatedEmojis",v,function(){return!0})];const{getCustomEmojiById:z}=m.findByStoreName("EmojiStore"),{getGuildId:B}=m.findByStoreName("SelectedGuildStore"),k=/<a?:(\w+):(\d+)>/i;function L(e,a){const r=e.matchAll(/<a?:(\w+):(\d+)>/gi),t=[];for(const c of r){const n=z(c[2]);(n.guildId!=B()||n.animated)&&(e=e.replace(c[0],""),o.storage.hyperLink===!0?t.push(`[${n.name}](${n.url.split("?")[0]}?size=${a}&name=${n.name})`):t.push(`${n.url.split("?")[0]}?size=${a}&name=${n.name}`))}return{newContent:e.trim(),extractedEmojis:t}}function p(e){if(!e.content.match(k))return;const{newContent:a,extractedEmojis:r}=L(e.content,o.storage.emojiSize);e.content=a,r.length>0&&(e.content+=`
`+r.join(`
`)),e.invalidEmojis=[]}const P=m.findByProps("sendMessage","receiveMessage"),_=m.findByProps("uploadLocalFiles");var C=[d.before("sendMessage",P,function(e){return p(e[1])}),d.before("uploadLocalFiles",_,function(e){return p(e[0].parsedMessage)})];const{getCustomEmojiById:F}=m.findByStoreName("EmojiStore"),h=m.findByName("RowManager"),u=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;var M=[d.before("generate",h.prototype,function(e){let[a]=e;var r;if(a.rowType!==1)return;let t=a.message.content;if(!t?.length)return;const c=(r=t.match(u))===null||r===void 0?void 0:r.index;if(c===void 0)return;const n=t.slice(c).trim().split(`
`);if(!n.every(function(s){return s.match(u)}))return;for(t=t.slice(0,c);t.indexOf("  ")!==-1;)t=t.replace("  ",` ${n.shift()} `);t=t.trim(),n.length&&(t+=` ${n.join(" ")}`);const i=a.message.embeds;for(let s=0;s<i.length;s++){const l=i[s];l.type==="image"&&l.url.match(u)&&i.splice(s--,1)}a.message.content=t,a.__realmoji=!0}),d.after("generate",h.prototype,function(e,a){let[r]=e;if(r.rowType!==1||r.__realmoji!==!0)return;const{content:t}=a.message;if(!Array.isArray(t))return;const c=t.every(function(i){return i.type==="link"&&i.target.match(u)||i.type==="text"&&i.content===" "});for(let i=0;i<t.length;i++){var n;const s=t[i];if(s.type!=="link")continue;const l=s.target.match(u);if(!l)continue;const S=s.target.split("&"),$=`${l[0]}?size=128`;let f=F(l[1])?.name;f===void 0&&(f="<realmoji>"),!((n=S[1])===null||n===void 0)&&n.startsWith("name")&&(f=S[1].replace("name=","")),t[i]={type:"customEmoji",id:l[1],alt:f,src:$,frozenSrc:$.replace("gif","webp"),jumboable:c?!0:void 0}}})];const{FormSection:y,FormRadioRow:x,FormSwitchRow:E,FormDivider:N}=w.Forms,T={Tiny:16,Small:32,Medium:48,Large:64,Huge:96,Jumbo:128},U="https://cdn.discordapp.com/emojis/926602689213767680.webp";function I(){return b.useProxy(o.storage),React.createElement(j.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(y,{title:"Emoji Size",titleStyleType:"no_border"},Object.entries(T).map(function(e){let[a,r]=e;return React.createElement(x,{label:a,subLabel:r,selected:o.storage.emojiSize===r,onPress:function(){o.storage.emojiSize=r}})})),React.createElement(y,{title:"Preview"},React.createElement(j.ReactNative.Image,{source:{uri:`${U}?size=${o.storage.emojiSize}`,width:o.storage.emojiSize,height:o.storage.emojiSize}})),React.createElement(y,{title:"User Profile",titleStyleType:"no_border"},React.createElement(E,{label:"Use hyperlinks when sending fake emojis",onValueChange:function(e){o.storage.hyperLink=e},value:o.storage.hyperLink}),React.createElement(N,null),React.createElement(E,{label:"Transform fake emojis into real ones",onValueChange:function(e){o.storage.transformEmoji=e},value:o.storage.transformEmoji})))}o.storage.emojiSize??=48,o.storage.hyperLink??=!0,o.storage.transformEmoji??=!0;const A=[...R,...C,...M];var O={settings:I,onUnload:function(){return A.forEach(function(e){return e()})}};return g.default=O,Object.defineProperty(g,"__esModule",{value:!0}),g})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
