(function(u,r,s,m,y,S,$){"use strict";const g=s.findByProps("canUseEmojisEverywhere");var w=[m.instead("canUseEmojisEverywhere",g,function(){return!0}),m.instead("canUseAnimatedEmojis",g,function(){return!0})];const{getCustomEmojiById:b}=s.findByStoreName("EmojiStore"),{getGuildId:R}=s.findByStoreName("SelectedGuildStore"),z=/<a?:(\w+):(\d+)>/i;function B(e,t){const i=e.matchAll(/<a?:(\w+):(\d+)>/gi),a=[];for(const o of i){const n=b(o[2]);(n.guildId!=R()||n.animated)&&(e=e.replace(o[0],""),r.storage.hyperLink===!0?a.push(`[${n.name}](${n.url.split("?")[0]}?size=${t}&name=${n.name})`):a.push(`${n.url.split("?")[0]}?size=${t}&name=${n.name}`))}return{newContent:e.trim(),extractedEmojis:a}}function j(e){if(!e.content.match(z))return;const{newContent:t,extractedEmojis:i}=B(e.content,r.storage.emojiSize);e.content=t,i.length>0&&(e.content+=`
`+i.join(`
`)),e.invalidEmojis=[]}const k=s.findByProps("sendMessage","receiveMessage"),L=s.findByProps("uploadLocalFiles");var P=[m.before("sendMessage",k,function(e){return j(e[1])}),m.before("uploadLocalFiles",L,function(e){return j(e[0].parsedMessage)})];const{getCustomEmojiById:_}=s.findByStoreName("EmojiStore"),h=s.findByName("RowManager"),l=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;var C=[m.before("generate",h.prototype,function([e]){if(e.rowType!==1)return;let t=e.message.content;if(!t?.length)return;const i=t.match(l)?.index;if(i===void 0)return;const a=t.slice(i).trim().split(`
`);if(!a.every(function(n){return n.match(l)}))return;for(t=t.slice(0,i);t.indexOf("  ")!==-1;)t=t.replace("  ",` ${a.shift()} `);t=t.trim(),a.length&&(t+=` ${a.join(" ")}`);const o=e.message.embeds;for(let n=0;n<o.length;n++){const c=o[n];c.type==="image"&&c.url.match(l)&&o.splice(n--,1)}e.message.content=t,e.__realmoji=!0}),m.after("generate",h.prototype,function([e],t){if(e.rowType!==1||e.__realmoji!==!0)return;const{content:i}=t.message;if(!Array.isArray(i))return;const a=i.every(function(o){return o.type==="link"&&o.target.match(l)||o.type==="text"&&o.content===" "});for(let o=0;o<i.length;o++){const n=i[o];if(n.type!=="link")continue;const c=n.target.match(l);if(!c)continue;const E=n.target.split("&"),v=`${c[0]}?size=128`;let d=_(c[1])?.name;d===void 0&&(d="<realmoji>"),E[1]?.startsWith("name")&&(d=E[1].replace("name=","")),i[o]={type:"customEmoji",id:c[1],alt:d,src:v,frozenSrc:v.replace("gif","webp"),jumboable:a?!0:void 0}}})];const{FormSection:f,FormRadioRow:F,FormSwitchRow:p,FormDivider:M}=S.Forms,x={Tiny:16,Small:32,Medium:48,Large:64,Huge:96,Jumbo:128},N="https://cdn.discordapp.com/emojis/926602689213767680.webp";function T(){return $.useProxy(r.storage),React.createElement(y.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(f,{title:"Emoji Size",titleStyleType:"no_border"},Object.entries(x).map(function([e,t]){return React.createElement(F,{label:e,subLabel:t,selected:r.storage.emojiSize===t,onPress:function(){r.storage.emojiSize=t}})})),React.createElement(f,{title:"Preview"},React.createElement(y.ReactNative.Image,{source:{uri:`${N}?size=${r.storage.emojiSize}`,width:r.storage.emojiSize,height:r.storage.emojiSize}})),React.createElement(f,{title:"User Profile",titleStyleType:"no_border"},React.createElement(p,{label:"Use hyperlinks when sending fake emojis",onValueChange:function(e){r.storage.hyperLink=e},value:r.storage.hyperLink}),React.createElement(M,null),React.createElement(p,{label:"Transform fake emojis into real ones",onValueChange:function(e){r.storage.transformEmoji=e},value:r.storage.transformEmoji})))}r.storage.emojiSize??=48,r.storage.hyperLink??=!0,r.storage.transformEmoji??=!0;const U=[...w,...P,...C];var I={settings:T,onUnload:function(){return U.forEach(function(e){return e()})}};return u.default=I,Object.defineProperty(u,"__esModule",{value:!0}),u})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
