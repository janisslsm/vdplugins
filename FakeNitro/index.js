(function(f,r,c,m,p,b,R){"use strict";const j=c.findByProps("canUseEmojisEverywhere");var z=[m.instead("canUseEmojisEverywhere",j,function(){return!0}),m.instead("canUseAnimatedEmojis",j,function(){return!0})];const{getCustomEmojiById:B}=c.findByStoreName("EmojiStore"),{getGuildId:k}=c.findByStoreName("SelectedGuildStore"),L=/<a?:(\w+):(\d+)>/i;function C(e,t){const a=e.matchAll(/<a?:(\w+):(\d+)>/gi),i=[];for(const o of a){const n=B(o[2]);if(n.guildId!=k()||n.animated){e=e.replace(o[0],"");const s=n?.url??`https://cdn.discordapp.com/emojis/${n.id}.webp?size=44&animated=${n.animated}`,d=n.animated?`&animated=${n.animated}`:"";r.storage.hyperLink===!0?i.push(`[${n.name}](${s.split("?")[0]}?size=${t}&name=${n.name}${d})`):i.push(`${s.split("?")[0]}?size=${t}&name=${n.name}${d}`)}}return{newContent:e.trim(),extractedEmojis:i}}function h(e){if(!e.content.match(L))return;const{newContent:t,extractedEmojis:a}=C(e.content,r.storage.emojiSize);e.content=t,a.length>0&&(e.content+=`
`+a.join(`
`)),e.invalidEmojis=[]}const F=c.findByProps("sendMessage","receiveMessage"),v=c.findByProps("uploadLocalFiles"),{getCurrentUser:E}=c.findByStoreName("UserStore"),$=[m.before("sendMessage",F,function(e){E?.().premiumType===null&&h(e[1])})];v?.uploadLocalFiles!==void 0&&$.push(m.before("uploadLocalFiles",v,function(e){E?.().premiumType===null&&h(e[0].parsedMessage)}));var P=[...$];const{getCustomEmojiById:T}=c.findByStoreName("EmojiStore"),S=c.findByName("RowManager"),l=/https:\/\/cdn.discordapp.com\/emojis\/(\d+)\.\w+/;var U=[m.before("generate",S.prototype,function([e]){if(e.rowType!==1)return;let t=e.message.content;if(!t?.length)return;const a=t.match(l)?.index;if(a===void 0)return;const i=t.slice(a).trim().split(`
`);if(!i.every(function(n){return n.match(l)}))return;for(t=t.slice(0,a);t.indexOf("  ")!==-1;)t=t.replace("  ",` ${i.shift()} `);t=t.trim(),i.length&&(t+=` ${i.join(" ")}`);const o=e.message.embeds;for(let n=0;n<o.length;n++){const s=o[n];s.type==="image"&&s.url.match(l)&&o.splice(n--,1)}e.message.content=t,e.__realmoji=!0}),m.after("generate",S.prototype,function([e],t){if(e.rowType!==1||e.__realmoji!==!0)return;const{content:a}=t.message;if(!Array.isArray(a))return;const i=a.every(function(o){return o.type==="link"&&o.target.match(l)||o.type==="text"&&o.content===" "});for(let o=0;o<a.length;o++){const n=a[o];if(n.type!=="link")continue;const s=n.target.match(l);if(!s)continue;const d=n.target.split("&"),g=`${s[0]}?size=128`;let u=T(s[1])?.name;u===void 0&&(u="<realmoji>"),d[1]?.startsWith("name")&&(u=d[1].replace("name=","")),a[o]={type:"customEmoji",id:s[1],alt:u,src:n.target.includes("animated=true")?g.replace("webp","gif"):g,frozenSrc:g.replace("gif","webp"),jumboable:i?!0:void 0}}})];const{FormSection:y,FormRadioRow:_,FormSwitchRow:w,FormDivider:M}=b.Forms,N={Tiny:16,Small:32,Medium:48,Large:64,Huge:96,Jumbo:128},x="https://cdn.discordapp.com/emojis/926602689213767680.webp";function I(){return R.useProxy(r.storage),React.createElement(p.ReactNative.ScrollView,{style:{flex:1},contentContainerStyle:{paddingBottom:38}},React.createElement(y,{title:"Emoji Size",titleStyleType:"no_border"},Object.entries(N).map(function([e,t]){return React.createElement(_,{label:e,subLabel:t,selected:r.storage.emojiSize===t,onPress:function(){r.storage.emojiSize=t}})})),React.createElement(y,{title:"Preview"},React.createElement(p.ReactNative.Image,{source:{uri:`${x}?size=${r.storage.emojiSize}`,width:r.storage.emojiSize,height:r.storage.emojiSize}})),React.createElement(y,{title:"User Profile",titleStyleType:"no_border"},React.createElement(w,{label:"Use hyperlinks when sending fake emojis",onValueChange:function(e){r.storage.hyperLink=e},value:r.storage.hyperLink}),React.createElement(M,null),React.createElement(w,{label:"Transform fake emojis into real ones",onValueChange:function(e){r.storage.transformEmoji=e},value:r.storage.transformEmoji})))}r.storage.emojiSize??=48,r.storage.hyperLink??=!0,r.storage.transformEmoji??=!0;const A=[...z,...P,...U];var O={settings:I,onUnload:function(){return A.forEach(function(e){return e()})}};return f.default=O,Object.defineProperty(f,"__esModule",{value:!0}),f})({},vendetta.plugin,vendetta.metro,vendetta.patcher,vendetta.metro.common,vendetta.ui.components,vendetta.storage);
